# model_view_controller.py
import mongo
import exceptions as exc

class Model(object):

    def __init__(self):
        self._connection = mongo.connect_database()
        mongo.create_malware_collection(self.connection)
        mongo.create_ip_collection(self.connection)
        mongo.create_vt_collection(self.connection)
        mongo.create_label_collection(self.connection)

    @property
    def connection(self):
        return self._connection

    def create_malware(self, id_malware, source_malware, date_added, url_malware, url_status, threat, tags, urlhaus_link, reporter_malware):
        mongo.create_malware_collection(
            self.connection, id_malware, source_malware, date_added, url_malware, url_status, threat, tags, urlhaus_link, reporter_malware)

    def read_malware(self, id_malware):
        return mongo.select_one_malware_collection(
            self.connection, id_malware)

    def read_malwares(self):
        return mongo.select_all_malware_collection(
            self.connection)

    def delete_malware(self, malware_id):
        mongo.delete_one_malware_collection(
            self.connection, malware_id)
            
    def create_ip(self, id_malware_ip, ip, country_name, country_code, continent_code, continent_name,region_name, region_code, city, zip, latitude, longitude, full_report):
        mongo.create_ip_collection(
            self.connection, id_malware_ip, ip, country_name, country_code, continent_code, continent_name,region_name, region_code, city, zip, latitude, longitude, full_report)

    def read_ip(self, id_malware_ip):
        return mongo.select_one_ip_collection(
            self.connection, id_malware_ip, table_name=self.item_type)

    def read_ips(self):
        return mongo.select_all_ip_collection(
            self.connection)

    def delete_ip(self, id_malware_ip):
        mongo.delete_one_ip_collection(
            self.connection, id_malware_ip)
            

    def create_label(self, id_malware_label, output_avclassplusplus):
        mongo.create_label_collection(
            self.connection, id_malware_label, output_avclassplusplus)

    def read_label(self, id_malware_label):
        return mongo.select_one_label_collection(
            self.connection, id_malware_label)

    def read_labels(self):
        return mongo.select_all_label_collection(
            self.connection)

    def delete_label(self, id_malware_label):
        mongo.delete_one_label_collection(
            self.connection, id_malware_label)
            
            
    def create_vt(self, scan_id_vt, total_scan_vt, positives_vt, resource_vt, response_vt, scan_date_vt, permalinks_vt, sha256_vt, md5_vt, sha1_vt, entire_report_vt, id_malware_vt):
        mongo.create_vt_collection(
            self.connection, scan_id_vt, total_scan_vt, positives_vt, resource_vt, response_vt, scan_date_vt, permalinks_vt, sha256_vt, md5_vt, sha1_vt, entire_report_vt, id_malware_vt)

    def read_vt(self, scan_id_vt):
        return mongo.select_one_vt_collection(
            self.connection, scan_id_vt)

    def read_vts(self):
        return mongo.select_all_vt_collection(
            self.connection)

    def delete_malware(self, scan_id_vt):
        mongo.delete_one_vt_collection(
            self.connection, scan_id_vt)
            
